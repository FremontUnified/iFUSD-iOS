iFUSD-iOS-Server
=========

iFUSD for iOS Server.
These files determine the content of the app.

1. Scraping
2. News
3. Calendar
4. Schools
5. Emergency
6. Settings/Push

The core feature of the code is this segment of PHP Code:

The $url variable is the CMS Page we've chosen
The preg_match uses regex to find the content of the page.

<?php
$url = 'http://www.fremont.k12.ca.us/Page/31';
$ch = curl_init ($url); //URL to Scrape
curl_setopt($ch, CURLOPT_RETURNTRANSFER, true);
$page = curl_exec($ch);

preg_match('#<div class="SWContentBODY" style="position: relative;"[^>]*>(.+?)<div class="ui-widget-footer">#is', $page, $matches, $links); // grabs anything between <p> </p> tags
foreach ($matches as &$match) {
    $match = str_replace('href="/', 'href="http://www.fmtusd.org/', $match); 
	//This is used to make sure links work and refer to the webserver not our scraping server.
}
// output html, styles, and more.
echo $matches[1]; 
?>

We use a NoClickDelay to help the application feel more responsive. 

----------------------

2. News


For the News Section:
1. We use an RSS feed. For instructions on how to do that see this: http://net.tutsplus.com/tutorials/javascript-ajax/how-to-build-an-rss-reader-with-jquery-mobile-2/
2. We then scrape the following url for the content and display it.


----------------------

3. Calendar.

We use an emebeded Google Calendar along with a url that points to the .ics version of the calendar generated by the CMS. See the code in /cal for more

--------------------

4. Schools. The files in /schools/ are a list of the schools in the district. The files in /detail/ provide the actual views. 
For the best implementation, see the directory /schools/detail/elementary. In the index.php we have a datasource and display the page based on what school was requested. 

----
5. Emergency. 

In the emergency section, we scrape the page that the district has set as the emergency update page. 

6. Settings/Push. 

For the Push Notification code, we use an implementaion of easyAPNS - https://github.com/manifestinteractive/easyapns . If you do not have the experience to implement push, please consider using services like Parse or UrbanAirship to send push notifications. 

See the easyAPNS folder for the base implementation

